---
import type { SocialLinks } from "@/types";
import { SiXiaohongshu } from "react-icons/si";
import {
  FaEnvelope,
  FaGithub,
  FaInstagram,
  FaGlobe,
  FaWeixin,
} from "react-icons/fa";
import GlassButton from "@components/ui/GlassButton.astro";

interface Props {
  links?: SocialLinks;
}

const { links } = Astro.props;

const liClass = "inline-block px-1 intersect:animate-fade opacity-0";
const iconClass =
  "glass-l hover:glass rounded text-txt-light dark:text-darkmode-txt-p flex h-9 w-9 items-center justify-center text-center transition duration-300";
---

{
  links && (
    <ul class="py-2 flex items-center">
      {links.wechat && (
        <li class={liClass}>
          <a id="wechat-popup-trigger" href="javascript:void(0);">
            <GlassButton
              id="wechatIcon"
              variant="info"
              size="sm"
              iconPosition="left"
              title="微信"
              className="min-w-10 justify-center"
            >
              <span class="sr-only">公众号</span>
              <FaWeixin className="w-6 h-6   dark:hover:text-green-600 hover:text-green-600 transition duration-300" />
            </GlassButton>
          </a>
        </li>
      )}
      {links.xhs && (
        <li class={liClass}>
          <a href={links.xhs}>
            <GlassButton
              id="xhs"
              variant="info"
              size="sm"
              iconPosition="left"
              title="小红书"
              className="min-w-10 justify-center"
            >
              <span class="sr-only">小红书</span>
              <SiXiaohongshu className="w-6 h-6  dark:hover:text-red-600 hover:text-red-600 transition duration-300" />
            </GlassButton>
          </a>
        </li>
      )}
      {links.email && (
        <li class={liClass}>
          <a href={`mailto:${links.email}`}>
            <GlassButton
              id="email"
              variant="info"
              size="sm"
              iconPosition="left"
              title="Email"
              className="min-w-10 justify-center"
            >
              <span class="sr-only">Email</span>
              <FaEnvelope className="w-6 h-6  dark:hover:text-yellow-200 hover:text-yellow-200 transition duration-300" />
            </GlassButton>
          </a>
        </li>
      )}
      {links.github && (
        <li class={liClass}>
          <a href={links.github}>
            <GlassButton
              id="github"
              variant="info"
              size="sm"
              iconPosition="left"
              title="GitHub"
              className="min-w-10 justify-center"
            >
              <span class="sr-only">GitHub</span>
              <FaGithub className="w-6 h-6  dark:hover:text-black hover:text-black transition duration-300" />
            </GlassButton>
          </a>
        </li>
      )}
    </ul>
  )
}

<script>
  import { showToast } from "@lib/toastUtils.ts";
  import wechatQrCode from "@assets/image/公众号.png";

  function setupWechatPopup() {
    const wechatTrigger = document.getElementById("wechat-popup-trigger");
    if (wechatTrigger) {
      wechatTrigger.addEventListener("click", (e) => {
        e.preventDefault();
        showToast({
          title: "关注我的公众号",
          content: `<img src="${wechatQrCode.src}" alt="微信公众号二维码" class="w-full h-auto rounded-lg">`,
          type: 'info',
          duration: 0, 
          closable: true,
          position: 'top-center'
        });
      });
    }
  }

  document.addEventListener("astro:page-load", setupWechatPopup);
</script>

